# People-Counting
people counting algorithm to achieve accurate counting when using yolo models with small datasets. This algorithm minimizes the counting error that occurs when there is a problem in object recognition and tracking.

<img src="https://user-images.githubusercontent.com/50966325/145721226-d8996a18-f6a1-45e4-beea-ff6105e94684.PNG"  width="600" height="350"/>

## Introduction

This repository contains a two-stage-tracker. The detections generated by [YOLOv5](https://github.com/ultralytics/yolov5), a family of object detection architectures and models pretrained on the COCO dataset, are passed to a [Deep Sort algorithm](https://github.com/ZQPei/deep_sort_pytorch) which tracks the objects. It can track any object that your Yolov5 model was trained to detect.


## Before you run

1. Clone the repository recursively:

`git clone https://github.com/sentiers/People-Counting.git`


2. Make sure that you fulfill all the requirements: Python 3.8 or later with all requirements.txt dependencies installed, including torch>=1.7. To install, run:

`pip install -r requirements.txt`


## Tracking sources

Tracking can be run on most video formats

```bash
python3 track.py --source ... --show-vid  # show live inference results as well
```

- Video:  `--source file.mp4`
- Webcam:  `--source 0`


## Select a Yolov5 family model

There is a clear trade-off between model inference speed and accuracy. In order to make it possible to fulfill your inference speed/accuracy needs
you can select a Yolov5 family model for automatic download

```bash

$ python track.py --source 0 --yolo_weights yolov5s.pt --img 640
                                            yolov5m.pt
                                            yolov5l.pt 
                                            yolov5x.pt --img 1280
```


## Simple Web Application

<img src="https://user-images.githubusercontent.com/50966325/145721390-89d9eb51-718f-4137-b2e1-f7af0d15e507.PNG"  width="500" height="350"/>

Can be run in localhost:8080 by 

```bash
npm start
```

## Reference
<a href='https://github.com/ultralytics/yolov5'>Yolov5</a>, <a href='https://github.com/mikel-brostrom/Yolov5_DeepSort_Pytorch'>Yolov5 DeepSort</a>
